---
apiVersion: kyverno.io/v2alpha1
kind: PolicyException
metadata:
  name: flux-app-capz-special
  namespace: policy-exceptions
spec:
  background: true
  exceptions:
    - policyName: disallow-host-path
      ruleNames:
        - host-path
        - autogen-host-path
        - autogen-cronjob-host-path
    - policyName: restrict-volume-types
      ruleNames:
        - restricted-volumes
        - autogen-restricted-volumes
        - autogen-cronjob-restricted-volumes
  match:
    any:
      - resources:
          kinds:
            - Deployment
            - ReplicaSet
            - Pod
            - Job
          names:
            - helm-controller*
            - image-automation-controller*
            - image-reflector-controller*
            - kustomize-controller*
            - notification-controller*
            - source-controller*
            - flux-app-crd-install*
          namespaces:
            - flux-giantswarm
