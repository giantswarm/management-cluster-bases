apiVersion: cli.kyverno.io/v1alpha1
kind: Test
metadata:
  name: singleton-flux-instance
policies:
  - ../../../../bases/flux-operator/clusterpolicy.yaml
resources:
  - resources.yaml
results:
  - policy: flux-operator-multi-tenancy
    rule: fluxInstanceMustBeSingleton
    resources:
    - flux-giantswarm/flux
    kind: ResourceSet
    result: pass
  - policy: flux-operator-multi-tenancy
    rule: fluxInstanceMustBeSingleton
    resources:
    - org-test/flux
    kind: ResourceSet
    result: fail
